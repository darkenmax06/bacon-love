import { c as createComponent, d as createAstro, a as renderTemplate, h as defineScriptVars, e as addAttribute, m as maybeRenderHead } from './astro/server_BB4gczNh.mjs';
import 'piccolore';
import 'clsx';
/* empty css                                */

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Astro = createAstro();
const $$DatePicker = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$DatePicker;
  const {
    id = "datepicker",
    name = "date",
    required = false,
    placeholder,
    defaultDate,
    lang = "es"
  } = Astro2.props;
  const monthNames = lang === "es" ? ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"] : ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
  const dayNames = lang === "es" ? ["Dom", "Lun", "Mar", "Mi\xE9", "Jue", "Vie", "S\xE1b"] : ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
  return renderTemplate(_a || (_a = __template(["", '<div class="datepicker-wrapper"', ' data-astro-cid-adgd7u3k> <input type="hidden"', "", "", "", ' data-astro-cid-adgd7u3k> <button type="button" class="datepicker-trigger" data-astro-cid-adgd7u3k> <span class="selected-date" data-astro-cid-adgd7u3k>', '</span> <svg class="calendar-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" data-astro-cid-adgd7u3k> <rect x="3" y="4" width="14" height="14" rx="2" stroke-width="2" data-astro-cid-adgd7u3k></rect> <path d="M3 8h14M7 2v4M13 2v4" stroke-width="2" stroke-linecap="round" data-astro-cid-adgd7u3k></path> </svg> </button> <div class="datepicker-dropdown" style="display: none;" data-astro-cid-adgd7u3k> <div class="datepicker-header" data-astro-cid-adgd7u3k> <button type="button" class="nav-btn prev-month" aria-label="Mes anterior" data-astro-cid-adgd7u3k>\n\u2039\n</button> <div class="current-month" data-astro-cid-adgd7u3k></div> <button type="button" class="nav-btn next-month" aria-label="Mes siguiente" data-astro-cid-adgd7u3k>\n\u203A\n</button> </div> <div class="datepicker-calendar" data-astro-cid-adgd7u3k> <div class="calendar-weekdays" data-astro-cid-adgd7u3k> ', ' </div> <div class="calendar-days" data-astro-cid-adgd7u3k></div> </div> </div> </div> <script>(function(){', "\n(function() {\n  const wrapper = document.querySelector(`.datepicker-wrapper[data-id=\"${id}\"]`);\n  if (!wrapper) return;\n\n  const hiddenInput = wrapper.querySelector('input[type=\"hidden\"]');\n  const trigger = wrapper.querySelector('.datepicker-trigger');\n  const dropdown = wrapper.querySelector('.datepicker-dropdown');\n  const selectedDateSpan = wrapper.querySelector('.selected-date');\n  const currentMonthEl = wrapper.querySelector('.current-month');\n  const prevBtn = wrapper.querySelector('.prev-month');\n  const nextBtn = wrapper.querySelector('.next-month');\n  const calendarDays = wrapper.querySelector('.calendar-days');\n\n  let settings = null;\n  let closedDates = [];\n  let currentDate = new Date();\n  let selectedDate = defaultDate ? new Date(defaultDate + 'T00:00:00.000Z') : null;\n  let minDate = new Date();\n  minDate.setHours(0, 0, 0, 0);\n  let maxDate = null;\n  let dataLoaded = false;\n\n  // Load settings and closed dates\n  async function loadData() {\n    try {\n      const [settingsRes, closedDatesRes] = await Promise.all([\n        fetch('/api/settings'),\n        fetch('/api/closed-dates')\n      ]);\n\n      const settingsData = await settingsRes.json();\n      const closedDatesData = await closedDatesRes.json();\n\n      settings = settingsData.settings;\n      closedDates = closedDatesData.closedDates.map(cd => {\n        const date = new Date(cd.date);\n        return {\n          ...cd,\n          dateStr: `${date.getUTCFullYear()}-${String(date.getUTCMonth() + 1).padStart(2, '0')}-${String(date.getUTCDate()).padStart(2, '0')}`\n        };\n      });\n\n      // Calculate maxDate based on advanceBookingDays\n      maxDate = new Date();\n      maxDate.setDate(maxDate.getDate() + settings.advanceBookingDays);\n      maxDate.setHours(23, 59, 59, 999);\n\n      dataLoaded = true;\n      renderCalendar();\n    } catch (error) {\n      console.error('Error loading datepicker data:', error);\n      dataLoaded = true; // Allow opening even on error\n    }\n  }\n\n  // Check if a day is enabled in schedules\n  function isDayEnabled(date) {\n    if (!settings) return true;\n\n    const dayOfWeek = date.getDay().toString();\n\n    if (settings.daySchedules) {\n      const daySchedule = settings.daySchedules[dayOfWeek];\n      return daySchedule && daySchedule.enabled && daySchedule.times.length > 0;\n    } else {\n      // Legacy system\n      return settings.openDays.includes(dayOfWeek);\n    }\n  }\n\n  // Check if date is closed\n  function isClosedDate(dateStr) {\n    return closedDates.some(cd => cd.dateStr === dateStr);\n  }\n\n  // Check if date is selectable\n  function isSelectableDate(date) {\n    if (!settings) return false;\n\n    const dateObj = new Date(date);\n    dateObj.setHours(0, 0, 0, 0);\n\n    // Check if date is in valid range\n    if (dateObj < minDate || dateObj > maxDate) return false;\n\n    // Format date string for comparison\n    const dateStr = `${dateObj.getFullYear()}-${String(dateObj.getMonth() + 1).padStart(2, '0')}-${String(dateObj.getDate()).padStart(2, '0')}`;\n\n    // Check if date is closed\n    if (isClosedDate(dateStr)) return false;\n\n    // Check if day of week is enabled\n    if (!isDayEnabled(dateObj)) return false;\n\n    return true;\n  }\n\n  // Format date for display\n  function formatDate(date) {\n    const d = new Date(date);\n    const day = String(d.getUTCDate()).padStart(2, '0');\n    const month = String(d.getUTCMonth() + 1).padStart(2, '0');\n    const year = d.getUTCFullYear();\n    return `${day}/${month}/${year}`;\n  }\n\n  // Render calendar\n  function renderCalendar() {\n    const year = currentDate.getFullYear();\n    const month = currentDate.getMonth();\n\n    // Update header\n    currentMonthEl.textContent = `${monthNames[month]} ${year}`;\n\n    // Get first day of month and number of days\n    const firstDay = new Date(year, month, 1).getDay();\n    const daysInMonth = new Date(year, month + 1, 0).getDate();\n\n    // Clear calendar\n    calendarDays.innerHTML = '';\n\n    // Add empty cells for days before month starts\n    for (let i = 0; i < firstDay; i++) {\n      const emptyCell = document.createElement('div');\n      emptyCell.className = 'calendar-day empty';\n      calendarDays.appendChild(emptyCell);\n    }\n\n    // Add days of month\n    for (let day = 1; day <= daysInMonth; day++) {\n      const date = new Date(year, month, day);\n      const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;\n\n      const dayCell = document.createElement('button');\n      dayCell.type = 'button';\n      dayCell.className = 'calendar-day';\n      dayCell.textContent = day;\n      dayCell.dataset.date = dateStr;\n\n      // Check if this is today\n      const today = new Date();\n      if (date.getFullYear() === today.getFullYear() &&\n          date.getMonth() === today.getMonth() &&\n          date.getDate() === today.getDate()) {\n        dayCell.classList.add('today');\n      }\n\n      // Check if this is selected date\n      if (selectedDate && date.getFullYear() === selectedDate.getUTCFullYear() &&\n          date.getMonth() === selectedDate.getUTCMonth() &&\n          date.getDate() === selectedDate.getUTCDate()) {\n        dayCell.classList.add('selected');\n      }\n\n      // Check if date is selectable\n      if (isSelectableDate(date)) {\n        dayCell.addEventListener('click', () => selectDate(dateStr));\n      } else {\n        dayCell.classList.add('disabled');\n        dayCell.disabled = true;\n\n        // Add closed indicator\n        if (isClosedDate(dateStr)) {\n          dayCell.classList.add('closed');\n          const closedInfo = closedDates.find(cd => cd.dateStr === dateStr);\n          dayCell.title = closedInfo ? closedInfo.reason : 'Cerrado';\n        }\n      }\n\n      calendarDays.appendChild(dayCell);\n    }\n\n    // Update navigation buttons\n    updateNavButtons();\n  }\n\n  // Update navigation button states\n  function updateNavButtons() {\n    if (!settings) return;\n\n    const currentMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);\n    const maxMonth = new Date(maxDate.getFullYear(), maxDate.getMonth(), 1);\n    const minMonth = new Date(minDate.getFullYear(), minDate.getMonth(), 1);\n\n    // Disable prev button if at or before current month\n    prevBtn.disabled = currentMonth <= minMonth;\n\n    // Disable next button if at or after max booking month\n    nextBtn.disabled = currentMonth >= maxMonth;\n  }\n\n  // Select date\n  function selectDate(dateStr) {\n    selectedDate = new Date(dateStr + 'T00:00:00.000Z');\n    hiddenInput.value = dateStr;\n    selectedDateSpan.textContent = formatDate(selectedDate);\n\n    // Dispatch custom event with date detail\n    const customEvent = new CustomEvent('date-selected', {\n      bubbles: true,\n      detail: { date: dateStr }\n    });\n    document.dispatchEvent(customEvent);\n\n    // Also dispatch change event for backward compatibility\n    hiddenInput.dispatchEvent(new Event('change', { bubbles: true }));\n\n    // Close dropdown\n    dropdown.style.display = 'none';\n\n    // Re-render to update selected state\n    renderCalendar();\n  }\n\n  // Toggle dropdown\n  trigger.addEventListener('click', () => {\n    if (!dataLoaded) {\n      // Still loading data, show in button or wait\n      return;\n    }\n    const isVisible = dropdown.style.display !== 'none';\n    dropdown.style.display = isVisible ? 'none' : 'block';\n\n    // Render calendar when opening if not visible before\n    if (!isVisible) {\n      renderCalendar();\n    }\n  });\n\n  // Navigation\n  prevBtn.addEventListener('click', () => {\n    currentDate.setMonth(currentDate.getMonth() - 1);\n    renderCalendar();\n  });\n\n  nextBtn.addEventListener('click', () => {\n    currentDate.setMonth(currentDate.getMonth() + 1);\n    renderCalendar();\n  });\n\n  // Close dropdown when clicking outside\n  document.addEventListener('click', (e) => {\n    if (!wrapper.contains(e.target)) {\n      dropdown.style.display = 'none';\n    }\n  });\n\n  // Initialize\n  loadData();\n\n  // Update selected date display if defaultDate provided\n  if (defaultDate && selectedDate) {\n    selectedDateSpan.textContent = formatDate(selectedDate);\n  }\n})();\n})();<\/script> "], ["", '<div class="datepicker-wrapper"', ' data-astro-cid-adgd7u3k> <input type="hidden"', "", "", "", ' data-astro-cid-adgd7u3k> <button type="button" class="datepicker-trigger" data-astro-cid-adgd7u3k> <span class="selected-date" data-astro-cid-adgd7u3k>', '</span> <svg class="calendar-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" data-astro-cid-adgd7u3k> <rect x="3" y="4" width="14" height="14" rx="2" stroke-width="2" data-astro-cid-adgd7u3k></rect> <path d="M3 8h14M7 2v4M13 2v4" stroke-width="2" stroke-linecap="round" data-astro-cid-adgd7u3k></path> </svg> </button> <div class="datepicker-dropdown" style="display: none;" data-astro-cid-adgd7u3k> <div class="datepicker-header" data-astro-cid-adgd7u3k> <button type="button" class="nav-btn prev-month" aria-label="Mes anterior" data-astro-cid-adgd7u3k>\n\u2039\n</button> <div class="current-month" data-astro-cid-adgd7u3k></div> <button type="button" class="nav-btn next-month" aria-label="Mes siguiente" data-astro-cid-adgd7u3k>\n\u203A\n</button> </div> <div class="datepicker-calendar" data-astro-cid-adgd7u3k> <div class="calendar-weekdays" data-astro-cid-adgd7u3k> ', ' </div> <div class="calendar-days" data-astro-cid-adgd7u3k></div> </div> </div> </div> <script>(function(){', "\n(function() {\n  const wrapper = document.querySelector(\\`.datepicker-wrapper[data-id=\"\\${id}\"]\\`);\n  if (!wrapper) return;\n\n  const hiddenInput = wrapper.querySelector('input[type=\"hidden\"]');\n  const trigger = wrapper.querySelector('.datepicker-trigger');\n  const dropdown = wrapper.querySelector('.datepicker-dropdown');\n  const selectedDateSpan = wrapper.querySelector('.selected-date');\n  const currentMonthEl = wrapper.querySelector('.current-month');\n  const prevBtn = wrapper.querySelector('.prev-month');\n  const nextBtn = wrapper.querySelector('.next-month');\n  const calendarDays = wrapper.querySelector('.calendar-days');\n\n  let settings = null;\n  let closedDates = [];\n  let currentDate = new Date();\n  let selectedDate = defaultDate ? new Date(defaultDate + 'T00:00:00.000Z') : null;\n  let minDate = new Date();\n  minDate.setHours(0, 0, 0, 0);\n  let maxDate = null;\n  let dataLoaded = false;\n\n  // Load settings and closed dates\n  async function loadData() {\n    try {\n      const [settingsRes, closedDatesRes] = await Promise.all([\n        fetch('/api/settings'),\n        fetch('/api/closed-dates')\n      ]);\n\n      const settingsData = await settingsRes.json();\n      const closedDatesData = await closedDatesRes.json();\n\n      settings = settingsData.settings;\n      closedDates = closedDatesData.closedDates.map(cd => {\n        const date = new Date(cd.date);\n        return {\n          ...cd,\n          dateStr: \\`\\${date.getUTCFullYear()}-\\${String(date.getUTCMonth() + 1).padStart(2, '0')}-\\${String(date.getUTCDate()).padStart(2, '0')}\\`\n        };\n      });\n\n      // Calculate maxDate based on advanceBookingDays\n      maxDate = new Date();\n      maxDate.setDate(maxDate.getDate() + settings.advanceBookingDays);\n      maxDate.setHours(23, 59, 59, 999);\n\n      dataLoaded = true;\n      renderCalendar();\n    } catch (error) {\n      console.error('Error loading datepicker data:', error);\n      dataLoaded = true; // Allow opening even on error\n    }\n  }\n\n  // Check if a day is enabled in schedules\n  function isDayEnabled(date) {\n    if (!settings) return true;\n\n    const dayOfWeek = date.getDay().toString();\n\n    if (settings.daySchedules) {\n      const daySchedule = settings.daySchedules[dayOfWeek];\n      return daySchedule && daySchedule.enabled && daySchedule.times.length > 0;\n    } else {\n      // Legacy system\n      return settings.openDays.includes(dayOfWeek);\n    }\n  }\n\n  // Check if date is closed\n  function isClosedDate(dateStr) {\n    return closedDates.some(cd => cd.dateStr === dateStr);\n  }\n\n  // Check if date is selectable\n  function isSelectableDate(date) {\n    if (!settings) return false;\n\n    const dateObj = new Date(date);\n    dateObj.setHours(0, 0, 0, 0);\n\n    // Check if date is in valid range\n    if (dateObj < minDate || dateObj > maxDate) return false;\n\n    // Format date string for comparison\n    const dateStr = \\`\\${dateObj.getFullYear()}-\\${String(dateObj.getMonth() + 1).padStart(2, '0')}-\\${String(dateObj.getDate()).padStart(2, '0')}\\`;\n\n    // Check if date is closed\n    if (isClosedDate(dateStr)) return false;\n\n    // Check if day of week is enabled\n    if (!isDayEnabled(dateObj)) return false;\n\n    return true;\n  }\n\n  // Format date for display\n  function formatDate(date) {\n    const d = new Date(date);\n    const day = String(d.getUTCDate()).padStart(2, '0');\n    const month = String(d.getUTCMonth() + 1).padStart(2, '0');\n    const year = d.getUTCFullYear();\n    return \\`\\${day}/\\${month}/\\${year}\\`;\n  }\n\n  // Render calendar\n  function renderCalendar() {\n    const year = currentDate.getFullYear();\n    const month = currentDate.getMonth();\n\n    // Update header\n    currentMonthEl.textContent = \\`\\${monthNames[month]} \\${year}\\`;\n\n    // Get first day of month and number of days\n    const firstDay = new Date(year, month, 1).getDay();\n    const daysInMonth = new Date(year, month + 1, 0).getDate();\n\n    // Clear calendar\n    calendarDays.innerHTML = '';\n\n    // Add empty cells for days before month starts\n    for (let i = 0; i < firstDay; i++) {\n      const emptyCell = document.createElement('div');\n      emptyCell.className = 'calendar-day empty';\n      calendarDays.appendChild(emptyCell);\n    }\n\n    // Add days of month\n    for (let day = 1; day <= daysInMonth; day++) {\n      const date = new Date(year, month, day);\n      const dateStr = \\`\\${year}-\\${String(month + 1).padStart(2, '0')}-\\${String(day).padStart(2, '0')}\\`;\n\n      const dayCell = document.createElement('button');\n      dayCell.type = 'button';\n      dayCell.className = 'calendar-day';\n      dayCell.textContent = day;\n      dayCell.dataset.date = dateStr;\n\n      // Check if this is today\n      const today = new Date();\n      if (date.getFullYear() === today.getFullYear() &&\n          date.getMonth() === today.getMonth() &&\n          date.getDate() === today.getDate()) {\n        dayCell.classList.add('today');\n      }\n\n      // Check if this is selected date\n      if (selectedDate && date.getFullYear() === selectedDate.getUTCFullYear() &&\n          date.getMonth() === selectedDate.getUTCMonth() &&\n          date.getDate() === selectedDate.getUTCDate()) {\n        dayCell.classList.add('selected');\n      }\n\n      // Check if date is selectable\n      if (isSelectableDate(date)) {\n        dayCell.addEventListener('click', () => selectDate(dateStr));\n      } else {\n        dayCell.classList.add('disabled');\n        dayCell.disabled = true;\n\n        // Add closed indicator\n        if (isClosedDate(dateStr)) {\n          dayCell.classList.add('closed');\n          const closedInfo = closedDates.find(cd => cd.dateStr === dateStr);\n          dayCell.title = closedInfo ? closedInfo.reason : 'Cerrado';\n        }\n      }\n\n      calendarDays.appendChild(dayCell);\n    }\n\n    // Update navigation buttons\n    updateNavButtons();\n  }\n\n  // Update navigation button states\n  function updateNavButtons() {\n    if (!settings) return;\n\n    const currentMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);\n    const maxMonth = new Date(maxDate.getFullYear(), maxDate.getMonth(), 1);\n    const minMonth = new Date(minDate.getFullYear(), minDate.getMonth(), 1);\n\n    // Disable prev button if at or before current month\n    prevBtn.disabled = currentMonth <= minMonth;\n\n    // Disable next button if at or after max booking month\n    nextBtn.disabled = currentMonth >= maxMonth;\n  }\n\n  // Select date\n  function selectDate(dateStr) {\n    selectedDate = new Date(dateStr + 'T00:00:00.000Z');\n    hiddenInput.value = dateStr;\n    selectedDateSpan.textContent = formatDate(selectedDate);\n\n    // Dispatch custom event with date detail\n    const customEvent = new CustomEvent('date-selected', {\n      bubbles: true,\n      detail: { date: dateStr }\n    });\n    document.dispatchEvent(customEvent);\n\n    // Also dispatch change event for backward compatibility\n    hiddenInput.dispatchEvent(new Event('change', { bubbles: true }));\n\n    // Close dropdown\n    dropdown.style.display = 'none';\n\n    // Re-render to update selected state\n    renderCalendar();\n  }\n\n  // Toggle dropdown\n  trigger.addEventListener('click', () => {\n    if (!dataLoaded) {\n      // Still loading data, show in button or wait\n      return;\n    }\n    const isVisible = dropdown.style.display !== 'none';\n    dropdown.style.display = isVisible ? 'none' : 'block';\n\n    // Render calendar when opening if not visible before\n    if (!isVisible) {\n      renderCalendar();\n    }\n  });\n\n  // Navigation\n  prevBtn.addEventListener('click', () => {\n    currentDate.setMonth(currentDate.getMonth() - 1);\n    renderCalendar();\n  });\n\n  nextBtn.addEventListener('click', () => {\n    currentDate.setMonth(currentDate.getMonth() + 1);\n    renderCalendar();\n  });\n\n  // Close dropdown when clicking outside\n  document.addEventListener('click', (e) => {\n    if (!wrapper.contains(e.target)) {\n      dropdown.style.display = 'none';\n    }\n  });\n\n  // Initialize\n  loadData();\n\n  // Update selected date display if defaultDate provided\n  if (defaultDate && selectedDate) {\n    selectedDateSpan.textContent = formatDate(selectedDate);\n  }\n})();\n})();<\/script> "])), maybeRenderHead(), addAttribute(id, "data-id"), addAttribute(id, "id"), addAttribute(name, "name"), addAttribute(required, "required"), addAttribute(defaultDate || "", "value"), placeholder || (lang === "es" ? "Seleccionar fecha" : "Select date"), dayNames.map((day) => renderTemplate`<div class="weekday" data-astro-cid-adgd7u3k>${day}</div>`), defineScriptVars({ id, lang, monthNames, defaultDate }));
}, "C:/Users/admin/Desktop/baconlove/bacon-love/src/components/DatePicker.astro", void 0);

export { $$DatePicker as $ };
